# **開発タスクリスト**

本ドキュメントは、[設計書](./design.md)に基づき、実装に必要な開発タスクを管理するものである。

## **マイルストーン1: 基盤構築とデータインポート機能の実装**

まずはアプリケーションの土台を作り、中核機能であるCSVインポートとデータ登録を実装する。

-   [x] **1-1. 開発環境のセットアップ**
    -   [x] Googleスプレッドシート本体を作成する。
    -   [x] ローカルでの開発のため、`clasp` をインストールし、Googleアカウントへのログインとプロジェクトの紐付けを行う。
    -   [x] 設計書に基づき、`src` 以下のディレクトリ構成を作成する (`Triggers`, `Services`, `Repositories`)。
-   [x] **1-2. スプレッドシートのシート作成**
    -   [x] `DB_Transactions` シートを作成し、ヘッダー（日付, 内容, 金額など）を定義する。
    -   [x] `Settings` シートを作成し、カテゴリ分類ルール（キーワードとカテゴリの対応表）を仮定義する。
-   [x] **1-3. データ読み書きモジュールの実装**
    -   [x] `Repository_Spreadsheet.gs` を作成する。
    -   [x] `DB_Transactions` シートにデータを追記する関数を実装する。
    -   [x] `Settings` シートからカテゴリ分類ルールを読み込む関数を実装する。
-   [x] **1-4. CSVインポートサービスの実装**
    -   [x] `Service_CsvImporter.gs` を作成する。
    -   [x] まずは特定のCSVフォーマット（例: 楽天カード）に対応した解析ロジックを実装する。
-   [x] **1-5. カテゴリ分類サービスの実装**
    -   [x] `Service_Categorizer.gs` を作成する。
    -   [x] `Settings` シートから取得したルールに基づき、取引明細にカテゴリを付与するロジックを実装する。
-   [x] **1-6. 手動インポート機能のUI統合**
    -   [x] `Main.gs` に、スプレッドシートを開いた際にカスタムメニューを追加する `onOpen` トリガーを実装する。
    -   [x] メニューからファイル選択ダイアログ（GAS標準機能）を開き、`Service_CsvImporter.gs` と `Service_Categorizer.gs` を呼び出して手動でCSVをインポートできることを確認する。

-   [x] **1-7. 複数CSVフォーマットへの対応**
    -   [x] CSVフォーマット定義を管理するシート（例: `Settings_CsvFormats`）を作成する。
    -   [x] インポートダイアログで、対応フォーマットを選択できるUIを実装する。
    -   [x] 選択されたフォーマット定義に基づき、動的にCSVを解析するロジックを実装する。

## **マイルストーン2: レポート機能の実装と設計改善**

登録したデータを可視化するための基本的なレポート機能を実装する。また、収入・支出を明確に扱うための設計改善を行う。

-   [x] **2-1. レポート出力用シートの作成**
    -   [x] `Report_MonthlySummary` シートを作成する。
    -   [x] `Report_TransactionList` シートを作成する。
-   [ ] **2-2. DBスキーマの拡張**
    -   [ ] `DB_Transactions`シートに「種別」列（収入/支出）を追加する。
    -   [ ] `Settings_CsvFormats`シートに「デフォルト種別」列を追加する。
-   [ ] **2-3. データ永続化ロジックの更新**
    -   [ ] `Repository_Spreadsheet.gs` を更新し、「種別」列の書き込みに対応する。
    -   [ ] `Service_CsvImporter.gs` と `Main.gs` を更新し、インポート時に「種別」が正しく設定されるようにする。
-   [ ] **2-4. レポート生成ロジックの更新**
    -   [ ] `Service_ReportGenerator.gs` を更新し、金額の正負ではなく「種別」列に基づいて収支計算を行うように修正する。
-   [ ] **2-5. レポート機能のUI統合**
    -   [ ] `Main.gs` のカスタムメニューに「月次レポート生成」機能を追加する。
    -   [ ] メニューを実行すると、各レポートシートに結果が出力されることを確認する。

## **マイルストーン3: 応用機能と自動化の実装**

基本機能に加え、より高度な可視化機能や自動化を実装する。

-   [ ] **3-1. 資産推移グラフ機能の実装**
    -   [ ] `Report_AssetTransition` シートを作成する。
    -   [ ] `Service_ReportGenerator.gs` に、各月末時点の資産額を計算し、グラフを生成するロジック（F-07）を実装する。
    -   [ ] `Main.gs` のカスタムメニューに機能を追加し、グラフが描画されることを確認する。
-   [ ] **3-2. 割り勘計算機能の実装**
    -   [ ] `Service_SplitwiseCalculator.gs` を作成する（F-06）。
    -   [ ] `Settings` シートに割り勘対象を判定するためのキーワードを定義する欄を追加する。
    -   [ ] `Main.gs` のカスタムメニューに機能を追加し、計算結果が表示されることを確認する。
-   [ ] **3-3. CSVインポートの自動化**
    -   [ ] `Trigger_CsvImport.gs` を作成する。
    -   [ ] Google Driveの特定フォルダへのファイル追加を検知するトリガーをプログラムで設定する。
    -   [ ] 実際にフォルダにCSVファイルを配置し、自動で`DB_Transactions`シートにデータが追加されることを確認する。
